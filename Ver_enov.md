# Daily Japanese N2 衝刺計畫 - 版本演進日誌

這份文件記錄了 `Daily_Japanese` 專案從早期版本到最新版本的主要功能與 AI 提示詞 (Prompt) 的演進歷史。

---

## v0.0.28 (2026-01-22)
**類型：混合型更新 (Mixed Update)**

- **核心貢獻：功能新增 & AI 互動深化**
    1.  **【功能新增】每日測驗限制**：引入時區概念，限制使用者每天只能進行一次每日測驗。若當日已完成，程式將不會重複生成每日測驗。此舉大幅**增強了「每日進度」的嚴謹性與系統的穩健性**。
        - **(時區更新)**：根據使用者習慣，此版本的時間基準已從日本標準時間 (JST, UTC+9) **更新為台灣標準時間 (TWT, UTC+8)**。
    2.  **【AI 互動深化】引導式學習**：在批改作業的 AI 提示詞中，新增指令要求 AI 在使用者接近完成每日進度時，**以「選項」或「問句」主動引導使用者思考下一步的學習計畫** (例如：挑戰 Bonus 題)，將 AI 從批改者轉化為學習教練。
    3.  **【AI 動機強化】肯定挑戰價值**：在批改 Bonus 題的 AI 提示詞中，新增指令要求 AI **暗示「持續挑戰 Bonus」對 N2 合格的重要性**，為使用者的額外努力賦予更強的目標感與價值肯定。
- **AI Prompt 審查 (Prompt-Specific Review):**
    - **`grade_quiz_with_ai`**：提示詞變得更具策略性。它不再僅僅是評分和給予評語，而是被賦予了「引導學習流程」和「強化學習動機」的新職責。這使得 AI 的回饋更具前瞻性和目的性。
- **結論：** 一次非常成功的更新。它不僅透過增加每日限制提升了程式的健壯性，更關鍵的是，它讓 AI 的角色產生了質變，從一個被動的批改員，進化成一個**主動引導、賦予動機的智慧家教**。

---

## v0.0.27 (2026-01-21)
**類型：集大成之作 (The Definitive Edition)**

- **核心貢獻：錯誤修復 & 功能實裝 & 全面人格強化**
    1.  **【關鍵錯誤修復】**：徹底修復了 v0.0.26 中因 URL 包含 Markdown 語法而導致的**致命通訊中斷 Bug**。
    2.  **【功能實裝】**：隨著通訊 Bug 的修復，v0.0.26 設計的 **`[RE]` 客製化請求功能**（包含 AI 處理、JSON 解析、與出題系統的連動）**正式上線且完全可用**。
    3.  **【程式碼健壯性】**：在使用者資料結構中加入了對新欄位 `next_quiz_instruction` 的初始化處理，增強了版本的向後相容性。
- **AI Prompt 拋光 (Persona Polish)：**
    - **`assess_user_level` ([LV]指令)**：明確要求 AI 回傳的 `reason` 也必須使用「斯巴達教練語氣」，提升了人格一致性。
    - **`ai_correction` (作業批改)**：用 `⚠️ 創意要求` 強調，進一步鎖定 AI 禁止產出模板化的評語。
    - **`run_daily_quiz` (Bonus)**：將「創意開場白」的指令也加入到 Bonus 挑戰中，使其回應更多樣化。
- **結論：** **當時的最終完全體**。它繼承了 v0.0.26 的全部功能設計，修復了其致命錯誤，並對 AI 在所有互動環節的人格表現進行了全面打磨。

---

## v0.0.26 (2026-01-21)
**類型：功能升級 & 嚴重錯誤回歸**

- **核心功能升級：「`[RE]` 客製化請求」**
    1.  **新增 `[RE]` 指令**：允許使用者向 AI 提出「太難了」、「想學特定文法」等客製化請求。
    2.  **新增 `handle_custom_request` 函數**：一個全新的 AI 處理單元，能理解使用者意圖，並以 JSON 格式回傳系統指令（如 `adjust_difficulty`, `quiz_instruction`）。
    3.  **建立智慧連動**：`process_data` 能解析 `[RE]` 的結果，並將 `quiz_instruction` 儲存起來，供 `run_daily_quiz` 在下次出題時動態載入，實現「客製化出題」。
- **使用者體驗優化**：將 `[CH]` 指令更名為 `[LV]` (Level)，語意更清晰。
- **【嚴重錯誤】：** **再次引入了 v0.0.25 (損壞版) 的致命通訊 Bug**。由於 URL 中包含 Markdown 語法，導致程式完全無法與 Telegram API 溝通。
- **結論：** 一個在**功能設計上是巨大飛躍**的版本，但因一個低級錯誤而導致**完全無法運作**。

---

## v0.0.25 (2026-01-20)
**類型：錯誤修復 (Bug Fix) & 品質回歸**

- **核心貢獻：** 成功修復了先前損壞版本中，因 URL 包含 Markdown 語法而導致的**致命通訊 Bug**，讓程式恢復運作。
- **程式碼優化：** 微調了訊息處理順序，會先正規化全形括號 `［］` 再進行指令判斷，增強了 `[CH]` 指令的健壯性。
- **AI Prompt 品質回歸：** `ai_correction` 的提示詞意外地混合了 v0.0.23 的舊內容，雖然保留了 v0.0.24 的核心價值觀，但變得較為冗餘，**品質不如 v0.0.24 純淨**。
- **結論：** 一次使專案重回正軌的**必要修復**，但 AI 品質有輕微下降。

---

## v0.0.24 (2026-01-20)
**類型：AI 人格優化 & 品質強化 (AI Persona Optimization & Quality Enhancement)**

- **核心升級：AI 價值觀重塑**。`ai_correction` 的 Prompt 經歷了根本性的哲學升級，將核心目標從「找錯誤」重塑為**「追求像日本人一樣說話 (Natural Native Japanese)」**。
- **AI Prompt 精細化：**
    1.  **「錯誤」與「語感」的明確分離**：首次定義 `❌ 錯誤 (Mistake)`（必須扣分並收錄）和 `❕ 語感/風格 (Nuance)`（風格建議，不扣分）。
    2.  **獎勵道地口語**：Prompt **明確禁止** AI 將 `コーヒー屋`、`美味い` 等道地口語視為錯誤，反而要求給予**高度評價**，鼓勵使用者脫離教科書框架。
    3.  **弱點系統輸入精準化**：要求 AI 僅將**真正的文法/意思錯誤**回傳至 JSON 的 `mistakes` 陣列中。這極大化地提升了弱點學習系統的數據品質。
- **功能完整性：** 完整保留了 v0.0.23 的所有後端功能。
- **結論：** 一次對 AI 教練「靈魂」的重大升級。顯著提升了 AI 的教學品質、判斷力與人格魅力，是當時的**黃金標準版**。
